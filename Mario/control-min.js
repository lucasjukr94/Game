class entity{constructor(){}setPosition(x,y){this.x=x;this.y=y}setDimension(width,height){this.width=width;this.height=height}getX(){return this.x}getY(){return this.y}getWidth(){return this.width}getHeight(){return this.height}centerX(){return(this.x+this.width/2)}centerY(){return(this.y+this.height/2)}}class tile extends entity{constructor(x,y,width,height){super();super.setPosition(x,y);super.setDimension(width,height);this.filled=!1}setFill(fill){this.filled=fill}collisionTop(x,y){if(this.y<=y){return!1}return!0}collisionBottom(x,y){if(this.y+this.height>=y){return!1}return!0}collisionLeft(x,y){if(this.x<=x){return!1}return!0}collisionRight(x,y){if(this.x+this.width>=x){return!1}return!0}drawTile(canvas){if(this.filled){canvas.fillStyle="yellow";canvas.fillRect(this.x,this.y,this.width,this.height)}else{canvas.strokeStyle="green";canvas.strokeRect(this.x,this.y,this.width,this.height)}}}class wall{constructor(width,height){this.width=width;this.height=height;this.x=0;this.y=0}setPosition(x,y){this.x=x;this.y=y}drawWall(canvas){canvas.fillStyle="black";canvas.fillRect(this.x,this.y,this.width,this.height)}collisionTop(x,y){if(this.y+5<=y){return!1}return!0}collisionBottom(x,y){if(this.y+this.height-15>=y){return!1}return!0}collisionLeft(x,y){if(this.x+10<=x){return!1}return!0}collisionRight(x,y){if(this.x+this.width-15>=x){return!1}return!0}}class bola extends entity{constructor(x,y){super();super.setPosition(x,y);this.setVelX(1);this.setVelY(1);this.g=0.1}setVelX(velX){this.velX=velX}setVelY(velY){this.velY=velY}drawBola(canvas){canvas.fillStyle="#FF0000";canvas.fillRect(this.x,this.y,this.width,this.height)}move(keyDownA,keyDownS,keyDownD,keyDownW){if(keyDownA){this.x=this.x-this.velX}if(keyDownS){this.y=this.y+this.velY}if(keyDownD){this.x=this.x+this.velX}if(keyDownW){this.y=this.y-this.velY}}gravity(){this.y+=this.g}collision(entidade){if(this.centerX()<=entidade.x+entidade.width&&this.centerY()>=entidade.y&&this.centerY()<=entidade.y+entidade.height){return 1}if(this.centerX()>=entidade.x+entidade.width&&this.centerY()>=entidade.y&&this.centerY()<=entidade.y+entidade.height){return 2}if(this.centerY()>=entidade.y+entidade.height&&this.centerX()>=entidade.x&&this.centerX()<=entidade.x+entidade.width){return 3}if(this.centerY()<=entidade.y+entidade.height&&this.centerX()>=entidade.x&&this.centerX()<=entidade.x+entidade.width){return 4}return 0}ricochet(entidade){switch(this.collision(entidade)){case 1:this.x++;break;case 2:this.x--;break;case 3:this.y++;break;case 4:this.y--;break;default:this.y-=0.1;break}}near(entidade){if(this.y<entidade.y+10&&this.y>entidade.y-10&&this.x<entidade.x+10&&this.x>entidade.x-10){return!0}else{return!1}}}var canv=document.getElementById("canvas");var canvas=canv.getContext("2d");var keyDownA=!1,keyDownS=!1,keyDownD=!1,keyDownW=!1;var ball;var tijolos=[];var parede;$(document).ready(function(){setup()});$(document).keydown(function(ev){switch(String.fromCharCode(ev.which)){case 'A':keyDownA=!0;break;case 'S':keyDownS=!0;break;case 'D':keyDownD=!0;break;case 'W':keyDownW=!0;break}});$(document).keyup(function(ev){switch(String.fromCharCode(ev.which)){case 'A':keyDownA=!1;break;case 'S':keyDownS=!1;break;case 'D':keyDownD=!1;break;case 'W':keyDownW=!1;break}});function setup(){canv.focus();ball=new bola(50,50);ball.setDimension(10,10);ball.setPosition(250,200);parede=new wall(800,800);for(var j=0;j<80;j++){var tijolo=[];for(var i=0;i<80;i++){var t=new tile(0+10*i,0+10*j,10,10);if(j==50){if(i%3!=0){t.setFill(!0)}}if(j==53){if(i%7!=0){t.setFill(!0)}}tijolo.push(t)}tijolos.push(tijolo)}setInterval(function(){tick()},1);tick()}function tick(){parede.drawWall(canvas);var colLeft=!parede.collisionLeft(ball.x,ball.y);var colRight=!parede.collisionRight(ball.x,ball.y);var colTop=!parede.collisionTop(ball.x,ball.y);var colBottom=!parede.collisionBottom(ball.x,ball.y);for(var j=0;j<80;j++){for(var i=0;i<80;i++){if(tijolos[j][i].filled&&ball.near(tijolos[j][i])){ball.ricochet(tijolos[j][i])}tijolos[j][i].drawTile(canvas)}}if(colLeft&&colRight&&colTop&&colBottom){ball.move(keyDownA,keyDownS,keyDownD,keyDownW)}else{if(colLeft){ball.x--}if(colRight){ball.x++}if(colTop){ball.y--}if(colBottom){ball.y++}}ball.gravity();ball.drawBola(canvas)}